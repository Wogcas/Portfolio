---
import Layout from "../layouts/Layout.astro";
import TopNavbar from "../components/TopNavbar.astro";
import ProjectCard from "../components/ProjectCard.astro";
import ProjectModal from "../components/ProjectModal.astro";
import { getCollection } from "astro:content";
import { sortProjectsByDate } from "../scripts/sortedProjects.js";
import Footer from "../components/Footer.astro";
import skillsData from "../data/skills.json";

const projects = await getCollection("projects");
const sortedProjects = sortProjectsByDate(projects);

const sortedSkills = skillsData.sort(
    (a, b) => (a.order || 0) - (b.order || 0),
);
---

<Layout title="home">
    <TopNavbar />
    <div
        class="flex flex-col items-center justify-center min-h-[110vh] text-center -mt-20 relative"
        id="home"
        style="z-index: 1;"
    >
        <div class="home-light"></div>

        <h3 class="text-white text-xl mb-2 font-medium shadow-text">
            Hello I'm
        </h3>
        <h1 class="text-white text-7xl font-extrabold m-0 shadow-text">
            Gael Castro
        </h1>
        <h1 class="text-white text-6xl font-extrabold mt-2 shadow-text">
            Software Engineer & Web Developer
        </h1>
    </div>

    <div
        class="flex flex-col items-center justify-center min-h-screen text-center -mt-40 relative"
        id="about"
        style="z-index: 2:;"
    >
        <section
            class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center max-w-6xl mx-auto px-8"
        >
            <div class="flex justify-center pr-40 md:justify-end">
                <img
                    src="/images/shaw.jpg"
                    alt="Gael Castro"
                    class="w-max h-max object-cover shadow-lg"
                />
            </div>

            <div class="text-left">
                <h2 class="text-white text-5xl mb-6 shadow-text">About Me</h2>
                <p class="text-white text-lg mb-4 leading-relaxed">
                    Hello there! I'm <strong>Gael Castro</strong>. Someone with
                    interest in web development and a strong commitment to
                    continuous learning. A adaptive individual who possesses
                    logical reasoning skills, proactive attitude, effective
                    teamwork and interest on new technologies.
                </p>
                <p class="text-white text-lg leading-relaxed mt-10">
                    Follow me through my journey over time.
                </p>
            </div>
        </section>
    </div>

    <div
        id="projects"
        class="min-h-screen py-16 px-8 flex flex-col justify-center items-center"
    >
        <section class="max-w-7xl mx-auto w-full">
            <h2 class="text-white text-5xl mb-20 text-center shadow-text">
                Projects
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                {
                    sortedProjects.map((project) => (
                        <ProjectCard project={project} />
                    ))
                }
            </div>
        </section>
    </div>

    <!-- Modales de proyectos -->
    {sortedProjects.map((project) => <ProjectModal project={project} />)}

    <div class="py-8">
        <section
            id="experience"
            class="min-h-screen bg-red py-16 px-8 my-8 flex flex-col justify-center items-center text-center"
        >
            <h2 class="text-white text-5xl mb-8 shadow-text">Experience</h2>
        </section>
    </div>

    <div class="py-8">
        <section
            id="skills"
            class="min-h-screen bg-red py-16 px-8 my-8 flex flex-col justify-center items-center text-center"
        >
            <h2 class="text-white text-5xl mb-8 shadow-text">Skills</h2>

            <div class="max-w-5xl w-full">
                <div
                    class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"
                >
                    {
                        sortedSkills.map((skill) => (
                            <div class="skill-card group bg-gradient-to-br from-gray-900/40 to-gray-800/20 border border-gray-700/40 rounded-xl p-6 hover:border-red-500/60 hover:bg-gradient-to-br hover:from-gray-900/60 hover:to-gray-800/40 transition-all duration-300 hover:shadow-xl hover:shadow-red-500/20 hover:scale-105 flex flex-col items-center justify-center gap-4">
                                <h3 class="text-white text-lg font-medium text-center group-hover:text-red-400 transition-colors duration-300">
                                    {skill.name}
                                </h3>
                                {skill.category && (
                                    <span class="text-gray-400 text-sm">
                                        {skill.category}
                                    </span>
                                )}
                            </div>
                        ))
                    }
                </div>
            </div>
        </section>

        <section
            id="contact"
            class="py-16 px-8 my-8 flex flex-col justify-center items-center text-center"
        >
            <h2 class="text-white text-5xl mb-8 shadow-text">Contact</h2>

            <div class="max-w-4xl w-full">
                <p
                    class="text-white text-xl max-w-2xl mx-auto leading-relaxed mb-16"
                >
                    Nice you made it to the end! If you'd like to get in touch,
                    feel free to reach out.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                    <a
                        href="mailto:castromolinagael@gmail.com"
                        class="contact-card group bg-gradient-to-br from-gray-900/40 to-gray-800/20 border border-gray-700/40 rounded-2xl p-6 hover:border-red-500/60 hover:bg-gradient-to-br hover:from-gray-900/60 hover:to-gray-800/40 transition-all duration-300 hover:shadow-xl hover:shadow-red-500/20 hover:scale-105"
                    >
                        <div class="flex flex-col items-center gap-4">
                            <img
                                src="images/socials-icons/gmail.svg"
                                alt="Gmail"
                                class="contact-icon"
                            />
                            <p
                                class="text-white text-lg font-medium group-hover:text-red-400 transition-colors duration-300"
                            >
                                Send me an email!
                            </p>
                        </div>
                    </a>
                    <a
                        href="https://www.linkedin.com/in/gael-rafael-castro-molina-95080030a/"
                        target="_blank"
                        rel="noopener noreferrer"
                        class="contact-card group bg-gradient-to-br from-gray-900/40 to-gray-800/20 border border-gray-700/40 rounded-2xl p-6 hover:border-blue-500/60 hover:bg-gradient-to-br hover:from-gray-900/60 hover:to-gray-800/40 transition-all duration-300 hover:shadow-xl hover:shadow-blue-500/20 hover:scale-105"
                    >
                        <div class="flex flex-col items-center gap-4">
                            <img
                                src="images/socials-icons/linkedin.svg"
                                alt="LinkedIn"
                                class="contact-icon"
                            />
                            <p
                                class="text-white text-lg font-medium group-hover:text-blue-400 transition-colors duration-300"
                            >
                                Find me on LinkedIn.
                            </p>
                        </div>
                    </a>
                    <a
                        href="https://instagram.com"
                        target="_blank"
                        rel="noopener noreferrer"
                        class="contact-card group bg-gradient-to-br from-gray-900/40 to-gray-800/20 border border-gray-700/40 rounded-2xl p-6 hover:border-pink-500/60 hover:bg-gradient-to-br hover:from-gray-900/60 hover:to-gray-800/40 transition-all duration-300 hover:shadow-xl hover:shadow-pink-500/20 hover:scale-105"
                    >
                        <div class="flex flex-col items-center gap-4">
                            <img
                                src="images/socials-icons/instagram.svg"
                                alt="Instagram"
                                class="contact-icon"
                            />
                            <p
                                class="text-white text-lg font-medium group-hover:text-pink-400 transition-colors duration-300"
                            >
                                I also usually use Instagram.
                            </p>
                        </div>
                    </a>
                </div>
                <div
                    class="inline-flex items-center gap-3 bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/40 rounded-full px-8 py-4 shadow-lg shadow-green-500/10"
                >
                    <span class="relative flex h-3 w-3">
                        <span
                            class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"
                        ></span>
                        <span
                            class="relative inline-flex rounded-full h-3 w-3 bg-green-500 shadow-lg shadow-green-500/50"
                        ></span>
                    </span>
                    <span class="text-green-400 text-base font-medium"
                        >Currently available for new opportunities</span
                    >
                </div>
            </div>
        </section>
    </div>
    <Footer />
</Layout>

<script src="../scripts/projectModal.js"></script>
<script src="../scripts/contactView.js"></script>

<style>
    .shadow-text {
        text-shadow:
            0 0 8px rgba(255, 255, 255, 0.2),
            0 0 16px rgba(255, 255, 255, 0.15);
    }

    #home {
        position: relative;
        overflow: hidden;
    }

    .contact-icon {
        width: 50px;
        height: 50px;
        transition: transform 0.3s ease;
    }

    .home-light {
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 160%;
        height: 200%;
        background: radial-gradient(
            ellipse 40% 100% at 50% 10%,
            rgba(255, 51, 0, 0.6) 0%,
            rgba(207, 35, 0, 0.4) 20%,
            rgba(68, 16, 16, 0.3) 40%,
            rgba(52, 22, 22, 0.1) 60%,
            transparent 90%
        );
        filter: blur(20px);
        opacity: 0.7;
        z-index: -1;
        animation: simplePulse 3s ease-in-out infinite;
    }

    @keyframes simplePulse {
        0%,
        100% {
            opacity: 0.7;
        }
        50% {
            opacity: 0.9;
        }
    }

    @media (max-width: 600px) {
        .text-7xl {
            font-size: 2.2rem;
        }

        .text-6xl {
            font-size: 1.5rem;
        }

        .text-xl {
            font-size: 1rem;
        }

        .min-h-screen {
            min-height: 60vh;
        }

        .pt-20 {
            padding-top: 100px;
        }

        .text-5xl {
            font-size: 2rem;
        }

        .px-8 {
            padding-left: 10px;
            padding-right: 10px;
        }

        .home-light {
            width: 185%;
            height: 200%;
            filter: blur(20px);
        }
    }
</style>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";
    gsap.registerPlugin(ScrollTrigger);

    const homeSection = document.getElementById("home");
    const aboutSection = document.getElementById("about");
    const projectsSection = document.getElementById("projects");
    const contactSection = document.getElementById("contact");
    const skillsSection = document.getElementById("skills");

    gsap.to(homeSection, {
        scrollTrigger: {
            trigger: aboutSection,
            start: "top 80%",
            end: "top 20%",
            scrub: 1,
        },
        opacity: 0,
        y: -100,
        scale: 0.95,
        ease: "power2.out",
    });

    // Animación de fade in y slide up para about
    gsap.fromTo(
        aboutSection,
        {
            opacity: 0,
            y: 100,
        },
        {
            scrollTrigger: {
                trigger: aboutSection,
                start: "top 80%",
                end: "top 20%",
                scrub: 1,
            },
            opacity: 1,
            y: 0,
            ease: "power2.out",
        },
    );

    // Animación para la imagen del about (aparece desde la izquierda)
    gsap.fromTo(
        "#about img",
        {
            opacity: 0,
            x: -50,
        },
        {
            scrollTrigger: {
                trigger: aboutSection,
                start: "top 70%",
                end: "top 30%",
                scrub: 1,
            },
            opacity: 1,
            x: 0,
            ease: "power2.out",
        },
    );

    gsap.fromTo(
        "#about .text-left",
        {
            opacity: 0,
            x: 50,
        },
        {
            scrollTrigger: {
                trigger: aboutSection,
                start: "top 90%",
                end: "top 30%",
                scrub: 1,
            },
            opacity: 1,
            x: 0,
            ease: "power2.out",
        },
    );

    gsap.fromTo(
        projectsSection,
        {
            opacity: 0,
            y: 100,
        },
        {
            scrollTrigger: {
                trigger: projectsSection,
                start: "top 80%",
                end: "top 20%",
                scrub: 1,
            },
            opacity: 1,
            y: 0,
            ease: "power2.out",
        },
    );

    gsap.fromTo(
        "#projects .grid > div",
        {
            opacity: 0,
            y: 50,
            scale: 0.95,
        },
        {
            scrollTrigger: {
                trigger: projectsSection,
                start: "top 70%",
                end: "top 30%",
                scrub: 1,
            },
            opacity: 1,
            y: 0,
            scale: 1,
            stagger: 0.1,
            ease: "power2.out",
        },
    );

    gsap.fromTo(
        skillsSection,
        {
            opacity: 0,
            y: 100,
        },
        {
            scrollTrigger: {
                trigger: skillsSection,
                start: "top 80%",
                end: "top 20%",
                scrub: 1,
            },
            opacity: 1,
            y: 0,
            ease: "power2.out",
        },
    );

    gsap.fromTo(
        "#skills .grid > div",
        {
            opacity: 0,
            y: 50,
            scale: 0.95,
        },
        {
            scrollTrigger: {
                trigger: skillsSection,
                start: "top 70%",
                end: "top 30%",
                scrub: 1,
            },
            opacity: 1,
            y: 0,
            scale: 1,
            stagger: 0.1,
            ease: "power2.out",
        },
    );

    gsap.fromTo(
        "#contact h2, #contact > div > p",
        {
            opacity: 0,
            y: 50,
        },
        {
            scrollTrigger: {
                trigger: contactSection,
                start: "top 75%",
                end: "top 35%",
                scrub: 1,
            },
            opacity: 1,
            y: 0,
            stagger: 0.1,
            ease: "power2.out",
        },
    );

    gsap.fromTo(
        ".contact-card",
        {
            opacity: 0,
            y: 40,
            scale: 0.9,
        },
        {
            scrollTrigger: {
                trigger: contactSection,
                start: "top 65%",
                end: "top 25%",
                scrub: 1,
            },
            opacity: 1,
            y: 0,
            scale: 1,
            ease: "power2.out",
        },
    );

    gsap.fromTo(
        "#contact .inline-flex",
        {
            opacity: 0,
            y: 30,
            scale: 0.95,
        },
        {
            scrollTrigger: {
                trigger: contactSection,
                start: "top 60%",
                end: "top 20%",
                scrub: 1,
            },
            opacity: 1,
            y: 0,
            scale: 1,
            ease: "back.out(1.2)",
        },
    );
</script>
