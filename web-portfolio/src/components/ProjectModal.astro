---
const { project, isOpen } = Astro.props;
const { data, body } = project;

// Construir URL de skillicons si hay techs
const techIcons =
    data.techs && data.techs.length > 0
        ? `https://skillicons.dev/icons?i=${data.techs.join(",")}`
        : null;
---

<div
    class="project-modal fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4"
    id={`modal-${project.slug}`}
    style="display: none;"
>
    <div class="relative max-w-4xl w-full max-h-[90vh]">
        <div
            class="modal-content bg-[#151515] rounded-lg w-full max-h-[90vh] overflow-y-auto"
        >
            <div class="p-8 pt-16 relative">
            <!-- BotÃ³n de cerrar -->
            <button
                class="close-modal-btn absolute top-4 left-4 z-20 text-white hover:text-gray-300 transition-all duration-200"
                aria-label="Cerrar modal"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-10 h-10"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2.5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                >
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </button>

            <img
                src={data.img}
                alt={data.title}
                class="w-full h-64 object-cover rounded-lg mb-8"
            />

            <h2 class="text-white text-4xl font-bold mb-6">{data.title}</h2>

            {
                techIcons && (
                    <div class="mb-8">
                        <h3 class="text-white text-xl font-semibold mb-3">
                            Technologies
                        </h3>
                        <img
                            src={techIcons}
                            alt="Technologies used"
                            class="h-12"
                        />
                    </div>
                )
            }

            <div class="prose prose-invert max-w-none mb-20">
                <div
                    class="text-gray-300 text-lg leading-relaxed"
                    set:html={body}
                />
            </div>

            {
                data["git-repository"] && (
                    <a
                        href={data["git-repository"]}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="github-button inline-block bg-white text-gray-700 font-medium text-lg px-6 py-3 rounded-lg transition-all duration-200 hover:text-black"
                    >
                        View on GitHub
                    </a>
                )
            }
            </div>
        </div>
    </div>
</div>

<style>
    .modal-content {
        animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
        from {
            transform: translateY(-50px);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

    .close-modal-btn:hover {
        transform: translateX(-4px);
    }

    .close-modal-btn:active {
        transform: translateX(-2px);
    }

    .prose :global(p) {
        margin-bottom: 1rem;
    }

    .github-button {
        box-shadow:
            0 0 8px rgba(255, 255, 255, 0.3),
            0 0 15px rgba(255, 255, 255, 0.2),
            0 0 25px rgba(255, 255, 255, 0.15);
    }

    .github-button:hover {
        box-shadow:
            0 0 10px rgba(255, 255, 255, 0.4),
            0 0 20px rgba(255, 255, 255, 0.25),
            0 0 30px rgba(255, 255, 255, 0.2);
    }
</style>
